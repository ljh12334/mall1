import{i as u,_ as k,d as v,r as T,o as I,c as U,a as g,b as t,w as a,F as B,e as s,t as w}from"./index-32b023e5.js";import{c as F,E as c,a as L,b as W,d as _,e as z,f as O,g as $}from"./el-table-column-627de3cb.js";import{E as D,a as N,b as K,c as A}from"./el-form-item-dbf99e9b.js";import{T as M,E as q}from"./TPaginationSelect-7903e521.js";import{E as G}from"./el-input-number-f7918489.js";import"./el-message-dbac021e.js";function H(e){return u({url:"/mall/pms-product/page",method:"post",data:e})}function J(e){return u({url:`/mall/pms-product/one/${e}`,method:"get"})}function Q(e){return u({url:`/mall/pms-product/del/${e}`,method:"get"})}function R(e){return u({url:"/mall/pms-product/add",method:"post",data:e})}function X(e){return u({url:"/mall/pms-product/edit",method:"post",data:e})}function Y(e){return u({url:"/mall/pms-product-category/page",method:"post",data:e})}function Z(e){return u({url:"/mall/pms-brand/page",method:"post",data:e})}const x=v({data(){return{projects:[],categories:[],page:{total:0,current:1,size:5},selectPage:{total:0,current:1,size:6,pagerCount:5},selectBrandPage:{total:0,current:1,size:6,pagerCount:5},searchId:null,brands:[],dialogFormVisible:!1,project:{productSn:"",brandName:"",description:"",id:0,name:"",price:0,promotionPrice:0,promotionStartTime:new Date,recommandStatus:0,sort:0,subTitle:"",unit:""},formLabelWidth:80}},components:{"t-pagination-select":M},mounted(){this.getProjectsPage(1),this.getCategoriesPage(1),this.getBrandsPage(1)},methods:{getBrandsPage(e){Z({current:e,size:6}).then(r=>{const d=r.data.page;this.brands=d.records,this.selectBrandPage=d}).catch(r=>{console.log(r)})},getCategoriesPage(e){Y({current:e,size:6}).then(r=>{const d=r.data.page;this.categories=d.records,this.selectPage=d}).catch(r=>{console.log(r)})},pageBrandChange(e){this.getBrandsPage(e)},pageChange(e){this.getCategoriesPage(e)},search(){if(this.searchId==null||this.searchId==""){alert("请输入商品编号后查询");return}J(this.searchId).then(e=>{e.data==null?this.projects=[]:(this.projects=[],this.projects.push(e.data.help))}).catch(e=>{console.log(e)})},research(){this.searchId=null,this.getProjectsPage(1)},toEdit(e){this.dialogFormVisible=!0,this.project=F(e)},getProjectsPage(e){H({current:e,size:5}).then(r=>{console.log(r);const d=r.data.page;this.projects=d.records,this.page=d}).catch(r=>{console.log(r)})},currentchange(e){this.getProjectsPage(e),this.page.current=e},del(e){confirm("是否删除")==!0&&console.log(e),console.log(e),Q(e).then(l=>{if(l.success)this.getProjectsPage(this.page.current);else return!1}).catch(l=>{})},toAdd(){this.dialogFormVisible=!0,this.project={productSn:"",brandName:"",description:"",id:0,name:"",price:0,promotionPrice:0,promotionStartTime:new Date,recommandStatus:0,sort:0,subTitle:"",unit:""}},save(){const e=this.project;e.id==0?R(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getProjectsPage(this.page.current),c(l.msg);else return c(l.msg),!1}).catch(l=>{c("网络错误联系管理员")}):X(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getProjectsPage(this.page.current),c(l.msg);else return c(l.msg),!1}).catch(l=>{c("网络错误联系管理员")})}}}),ee={style:{"margin-top":"10px"}},te={style:{width:"95%",margin:"0 auto"}},le={class:"block"},oe={class:"dialog-footer"};function ae(e,l,r,d,re,ne){const m=K,n=D,p=N,i=z,V=L,j=W,h=G,P=q,b=T("t-pagination-select"),f=O,y=$,C=A,S=_;return I(),U(B,null,[g("div",ee,[g("div",te,[t(n,{label:"商品编号","label-width":80,style:{display:"inline-flex","margin-right":"10px"}},{default:a(()=>[t(m,{modelValue:e.searchId,"onUpdate:modelValue":l[0]||(l[0]=o=>e.searchId=o),placeholder:"请输入商品编号"},null,8,["modelValue"])]),_:1}),t(p,{type:"primary",onClick:e.search},{default:a(()=>[s("查询")]),_:1},8,["onClick"]),t(p,{type:"info",onClick:e.research},{default:a(()=>[s("重置")]),_:1},8,["onClick"]),t(p,{type:"success",onClick:e.toAdd,style:{float:"right","margin-right":"20px"}},{default:a(()=>[s("添加 ")]),_:1},8,["onClick"])]),t(V,{data:e.projects,stripe:"","default-sort":{prop:"sort",order:"descending"},style:{width:"95%",margin:"0 auto"}},{default:a(()=>[t(i,{prop:"id",label:"编号",width:"80"}),t(i,{label:"货号",width:"120",prop:"productSn"}),t(i,{prop:"name",label:"标题",width:"120"}),t(i,{prop:"subTitle",label:"副标题",width:"200"}),t(i,{prop:"sort",sortable:"",label:"排序",width:"120"}),t(i,{prop:"promotionPrice",label:"促销价格",width:"100"}),t(i,{label:"促销开始时间",width:"120"},{default:a(o=>[s(w(o.row.promotionStartTime!=null?o.row.promotionStartTime.replace("T"," ").slice(0,19):""),1)]),_:1}),t(i,{label:"价格",width:"100",prop:"price"}),t(i,{label:"推荐状态",width:"100"},{default:a(o=>[s(w(o.row.recommandStatus==0?"不推荐":"推荐"),1)]),_:1}),t(i,{label:"单位",width:"100",prop:"unit"}),t(i,{label:"描述",width:"150",prop:"description"}),t(i,{fixed:"right",label:"功能管理",width:"140"},{default:a(o=>[t(p,{type:"warning",size:"small",onClick:E=>e.toEdit(o.row)},{default:a(()=>[s("更新")]),_:2},1032,["onClick"]),t(p,{type:"danger",size:"small",onClick:E=>e.del(o.row.id)},{default:a(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(j,{layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,style:{width:"95%",margin:"0 auto"},onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),t(S,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":l[14]||(l[14]=o=>e.dialogFormVisible=o),title:"商品编辑"},{footer:a(()=>[g("span",oe,[t(p,{onClick:l[13]||(l[13]=o=>e.dialogFormVisible=!1)},{default:a(()=>[s("取消")]),_:1}),t(p,{type:"primary",onClick:e.save},{default:a(()=>[s("保存 ")]),_:1},8,["onClick"])])]),default:a(()=>[t(C,{model:e.project},{default:a(()=>[t(n,{label:"货号","label-width":e.formLabelWidth},{default:a(()=>[t(m,{modelValue:e.project.productSn,"onUpdate:modelValue":l[1]||(l[1]=o=>e.project.productSn=o),placeholder:"请输入货号",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"标题","label-width":e.formLabelWidth},{default:a(()=>[t(m,{modelValue:e.project.name,"onUpdate:modelValue":l[2]||(l[2]=o=>e.project.name=o),placeholder:"请输入标题",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"副标题","label-width":e.formLabelWidth},{default:a(()=>[t(m,{modelValue:e.project.subTitle,"onUpdate:modelValue":l[3]||(l[3]=o=>e.project.subTitle=o),placeholder:"请输入副标题",type:"textarea",style:{width:"80%"},rows:3},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"排序","label-width":e.formLabelWidth},{default:a(()=>[t(h,{modelValue:e.project.sort,"onUpdate:modelValue":l[4]||(l[4]=o=>e.project.sort=o),placeholder:"请输入排序",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"促销价格","label-width":e.formLabelWidth},{default:a(()=>[t(h,{modelValue:e.project.promotionPrice,"onUpdate:modelValue":l[5]||(l[5]=o=>e.project.promotionPrice=o),placeholder:"请输入促销价格",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"促销开始时间","label-width":100},{default:a(()=>[g("div",le,[t(P,{modelValue:e.project.promotionStartTime,"onUpdate:modelValue":l[6]||(l[6]=o=>e.project.promotionStartTime=o),type:"datetime",placeholder:"请选择促销开始时间"},null,8,["modelValue"])])]),_:1}),t(n,{label:"商品分类","label-width":e.formLabelWidth},{default:a(()=>[t(b,{onPageChange:e.pageChange,optionSource:e.categories,modelValue:e.project.productCategoryId,"onUpdate:modelValue":l[7]||(l[7]=o=>e.project.productCategoryId=o),labelKey:"name",valueKey:"id",style:{width:"90%"},placeholder:"请选择商品分类",paginationOption:e.selectPage},null,8,["onPageChange","optionSource","modelValue","paginationOption"])]),_:1},8,["label-width"]),t(n,{label:"所属品牌","label-width":e.formLabelWidth},{default:a(()=>[t(b,{onPageChange:e.pageBrandChange,optionSource:e.brands,modelValue:e.project.brandId,"onUpdate:modelValue":l[8]||(l[8]=o=>e.project.brandId=o),labelKey:"name",valueKey:"id",style:{width:"90%"},placeholder:"请选择所属品牌",paginationOption:e.selectBrandPage},null,8,["onPageChange","optionSource","modelValue","paginationOption"])]),_:1},8,["label-width"]),t(n,{label:"价格","label-width":e.formLabelWidth},{default:a(()=>[t(h,{modelValue:e.project.price,"onUpdate:modelValue":l[9]||(l[9]=o=>e.project.price=o),placeholder:"请输入价格",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"推荐状态","label-width":e.formLabelWidth},{default:a(()=>[t(y,{modelValue:e.project.recommandStatus,"onUpdate:modelValue":l[10]||(l[10]=o=>e.project.recommandStatus=o),placeholder:"请选择推荐状态",style:{width:"80%"}},{default:a(()=>[t(f,{label:"不推荐",value:0}),t(f,{label:"推荐",value:1})]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"单位","label-width":e.formLabelWidth},{default:a(()=>[t(m,{modelValue:e.project.unit,"onUpdate:modelValue":l[11]||(l[11]=o=>e.project.unit=o),placeholder:"请输入单位",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"描述","label-width":e.formLabelWidth},{default:a(()=>[t(m,{modelValue:e.project.description,"onUpdate:modelValue":l[12]||(l[12]=o=>e.project.description=o),placeholder:"请输入描述",type:"textarea",style:{width:"80%"},rows:3},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const ce=k(x,[["render",ae],["__scopeId","data-v-5fcffda4"]]);export{ce as default};
