import{_ as P,d as S,r as k,o as v,c as I,a as p,b as t,w as o,F,e as d,t as b}from"./index-32b023e5.js";import{c as T,E as c,a as U,b as z,d as L,e as W,f as O,g as $}from"./el-table-column-627de3cb.js";import{E as D,a as B,b as N,c as A}from"./el-form-item-dbf99e9b.js";import{T as K,E as M}from"./TPaginationSelect-7903e521.js";import{E as q}from"./el-input-number-f7918489.js";import{g as G,a as H,d as J,b as Q,u as R}from"./subject-880d8368.js";import{a as X}from"./subjectCategory-fd0eee59.js";import"./el-message-dbac021e.js";const Y=S({data(){return{subjects:[],page:{total:0,current:1,size:10},selectPage:{total:0,current:1,size:6,pagerCount:5},searchId:null,dialogFormVisible:!1,subject:{categoryId:0,commentCount:0,content:"",description:"",forwardCount:0,id:0,showStatus:1,title:"",createTime:new Date},categories:[],formLabelWidth:80}},mounted(){this.getSubjectsPage(1),this.getCategoriesPage(1)},components:{"t-pagination-select":K},methods:{search(){if(this.searchId==null||this.searchId==""){alert("请输入专题编号后查询");return}G(this.searchId).then(e=>{e.data==null?this.subjects=[]:(this.subjects=[],this.subjects.push(e.data.help))}).catch(e=>{console.log(e)})},research(){this.searchId=null,this.getSubjectsPage(1)},toEdit(e){this.dialogFormVisible=!0,this.subject=T(e)},getCategoriesPage(e){X({current:e,size:6}).then(s=>{const u=s.data.page;this.categories=u.records,this.selectPage=u}).catch(s=>{console.log(s)})},pageChange(e){this.getCategoriesPage(e)},getSubjectsPage(e){H({current:e,size:10}).then(s=>{console.log(s);const u=s.data.page;this.subjects=u.records,this.page=u}).catch(s=>{console.log(s)})},currentchange(e){this.getSubjectsPage(e),this.page.current=e},del(e){confirm("是否删除")==!0&&console.log(e),console.log(e),J(e).then(l=>{if(l.success)this.getSubjectsPage(this.page.current);else return!1}).catch(l=>{})},toAdd(){this.dialogFormVisible=!0,this.subject={categoryId:0,commentCount:0,content:"",description:"",forwardCount:0,id:0,showStatus:1,createTime:new Date,title:""}},save(){const e=this.subject;e.id==0?Q(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getSubjectsPage(this.page.current),c(l.msg);else return c(l.msg),!1}).catch(l=>{c("网络错误联系管理员")}):R(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getSubjectsPage(this.page.current),c(l.msg);else return c(l.msg),!1}).catch(l=>{c("网络错误联系管理员")})}}}),Z={style:{"margin-top":"10px"}},x={style:{width:"95%",margin:"0 auto"}},ee={class:"block"},te={class:"dialog-footer"};function le(e,l,s,u,ae,oe){const m=N,n=D,r=B,i=W,f=U,w=z,V=k("t-pagination-select"),g=q,h=O,C=$,j=M,y=A,_=L;return v(),I(F,null,[p("div",Z,[p("div",x,[t(n,{label:"专题编号","label-width":80,style:{display:"inline-flex","margin-right":"10px"}},{default:o(()=>[t(m,{modelValue:e.searchId,"onUpdate:modelValue":l[0]||(l[0]=a=>e.searchId=a),placeholder:"请输入专题编号"},null,8,["modelValue"])]),_:1}),t(r,{type:"primary",onClick:e.search},{default:o(()=>[d("查询")]),_:1},8,["onClick"]),t(r,{type:"info",onClick:e.research},{default:o(()=>[d("重置")]),_:1},8,["onClick"]),t(r,{type:"success",onClick:e.toAdd,style:{float:"right","margin-right":"40px"}},{default:o(()=>[d("添加 ")]),_:1},8,["onClick"])]),t(f,{data:e.subjects,style:{width:"95%",margin:"0 auto"}},{default:o(()=>[t(i,{prop:"id",label:"编号",width:"80"}),t(i,{prop:"title",label:"标题",width:"120"}),t(i,{prop:"commentCount",label:"评论数量",width:"100"}),t(i,{prop:"content",label:"内容",width:"120"}),t(i,{prop:"forwardCount",label:"转发数量",width:"100"}),t(i,{prop:"description",label:"描述",width:"120"}),t(i,{label:"显示状态",width:"100"},{default:o(a=>[d(b(a.row.showStatus==0?"不显示":"显示"),1)]),_:1}),t(i,{label:"创建时间",width:"120"},{default:o(a=>[d(b(a.row.createTime!=null?a.row.createTime.replace("T"," "):""),1)]),_:1}),t(i,{fixed:"right",label:"功能管理",width:"140"},{default:o(a=>[t(r,{type:"warning",size:"small",onClick:E=>e.toEdit(a.row)},{default:o(()=>[d("更新")]),_:2},1032,["onClick"]),t(r,{type:"danger",size:"small",onClick:E=>e.del(a.row.id)},{default:o(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(w,{layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,style:{width:"95%",margin:"0 auto"},onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),t(_,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":l[10]||(l[10]=a=>e.dialogFormVisible=a),title:"专题编辑"},{footer:o(()=>[p("span",te,[t(r,{onClick:l[9]||(l[9]=a=>e.dialogFormVisible=!1)},{default:o(()=>[d("取消")]),_:1}),t(r,{type:"primary",onClick:e.save},{default:o(()=>[d("保存 ")]),_:1},8,["onClick"])])]),default:o(()=>[t(y,{model:e.subject},{default:o(()=>[t(n,{label:"标题","label-width":e.formLabelWidth},{default:o(()=>[t(m,{modelValue:e.subject.title,"onUpdate:modelValue":l[1]||(l[1]=a=>e.subject.title=a),placeholder:"请输入标题",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"专题分类","label-width":e.formLabelWidth},{default:o(()=>[t(V,{onPageChange:e.pageChange,optionSource:e.categories,modelValue:e.subject.categoryId,"onUpdate:modelValue":l[2]||(l[2]=a=>e.subject.categoryId=a),labelKey:"name",valueKey:"id",style:{width:"90%"},placeholder:"请选择专题分类",paginationOption:e.selectPage},null,8,["onPageChange","optionSource","modelValue","paginationOption"])]),_:1},8,["label-width"]),t(n,{label:"评论数量","label-width":e.formLabelWidth},{default:o(()=>[t(g,{modelValue:e.subject.commentCount,"onUpdate:modelValue":l[3]||(l[3]=a=>e.subject.commentCount=a),placeholder:"请输入评论数量",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"转发数量","label-width":e.formLabelWidth},{default:o(()=>[t(g,{modelValue:e.subject.forwardCount,"onUpdate:modelValue":l[4]||(l[4]=a=>e.subject.forwardCount=a),placeholder:"请输入转发数量",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"显示状态","label-width":e.formLabelWidth},{default:o(()=>[t(C,{modelValue:e.subject.showStatus,"onUpdate:modelValue":l[5]||(l[5]=a=>e.subject.showStatus=a),placeholder:"请选择显示状态",style:{width:"80%"}},{default:o(()=>[t(h,{label:"不显示",value:0}),t(h,{label:"显示",value:1})]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"内容","label-width":e.formLabelWidth},{default:o(()=>[t(m,{modelValue:e.subject.content,"onUpdate:modelValue":l[6]||(l[6]=a=>e.subject.content=a),placeholder:"请输入内容",type:"textarea",style:{width:"80%"},rows:3},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"描述","label-width":e.formLabelWidth},{default:o(()=>[t(m,{modelValue:e.subject.description,"onUpdate:modelValue":l[7]||(l[7]=a=>e.subject.description=a),placeholder:"请输入描述",type:"textarea",style:{width:"80%"},rows:3},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"创建时间","label-width":e.formLabelWidth},{default:o(()=>[p("div",ee,[t(j,{modelValue:e.subject.createTime,"onUpdate:modelValue":l[8]||(l[8]=a=>e.subject.createTime=a),type:"datetime",placeholder:"请选择创建时间"},null,8,["modelValue"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const pe=P(Y,[["render",le],["__scopeId","data-v-3c84fa5d"]]);export{pe as default};
