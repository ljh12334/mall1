import{i as u,_ as P,d as E,r as v,o as I,c as S,a as p,b as t,w as o,F as N,e as s,t as b}from"./index-32b023e5.js";import{c as F,E as c,a as T,b as z,d as $,e as O,f as U,g as D}from"./el-table-column-627de3cb.js";import{E as L,a as W,b as B,c as A}from"./el-form-item-dbf99e9b.js";import{T as K,E as M}from"./TPaginationSelect-7903e521.js";import{a as q}from"./subject-880d8368.js";import"./el-message-dbac021e.js";function G(e){return u({url:"/mall/cms-subject-comment/page",method:"post",data:e})}function H(e){return u({url:`/mall/cms-subject-comment/one/${e}`,method:"get"})}function J(e){return u({url:`/mall/cms-subject-comment/del/${e}`,method:"get"})}function Q(e){return u({url:"/mall/cms-subject-comment/add",method:"post",data:e})}function R(e){return u({url:"/mall/cms-subject-comment/edit",method:"post",data:e})}const X=E({data(){return{comments:[],page:{total:0,current:1,size:10},selectPage:{total:0,current:1,size:6,pagerCount:5},searchId:null,dialogFormVisible:!1,comment:{content:"",createTime:new Date,id:0,memberNickName:"",showStatus:0,subjectId:0},subjects:[],formLabelWidth:80}},mounted(){this.getCommentsPage(1),this.getSubjectsPage(1)},components:{"t-pagination-select":K},methods:{search(){if(this.searchId==null||this.searchId==""){alert("请输入专题评论编号后查询");return}H(this.searchId).then(e=>{e.data==null?this.comments=[]:(this.comments=[],this.comments.push(e.data.help))}).catch(e=>{console.log(e)})},research(){this.searchId=null,this.getCommentsPage(1)},toEdit(e){this.dialogFormVisible=!0,this.comment=F(e)},getSubjectsPage(e){q({current:e,size:6}).then(n=>{const d=n.data.page;this.subjects=d.records,this.selectPage=d}).catch(n=>{console.log(n)})},pageChange(e){this.getSubjectsPage(e)},getCommentsPage(e){G({current:e,size:10}).then(n=>{console.log(n);const d=n.data.page;this.comments=d.records,this.page=d}).catch(n=>{console.log(n)})},currentchange(e){this.getCommentsPage(e),this.page.current=e},del(e){confirm("是否删除")==!0&&console.log(e),console.log(e),J(e).then(l=>{if(l.success)this.getCommentsPage(this.page.current);else return!1}).catch(l=>{})},toAdd(){this.dialogFormVisible=!0,this.comment={content:"",createTime:new Date,id:0,memberNickName:"",showStatus:0,subjectId:0}},save(){const e=this.comment;e.id==0?Q(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getCommentsPage(this.page.current),c(l.msg);else return c(l.msg),!1}).catch(l=>{c("网络错误联系管理员")}):R(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getCommentsPage(this.page.current),c(l.msg);else return c(l.msg),!1}).catch(l=>{c("网络错误联系管理员")})}}}),Y={style:{"margin-top":"10px"}},Z={style:{width:"95%",margin:"0 auto"}},x={class:"block"},ee={class:"dialog-footer"};function te(e,l,n,d,le,ae){const g=B,r=L,i=W,m=O,f=T,w=z,_=v("t-pagination-select"),h=U,C=D,V=M,y=A,k=$;return I(),S(N,null,[p("div",Y,[p("div",Z,[t(r,{label:"专题评论编号","label-width":110,style:{display:"inline-flex","margin-right":"10px"}},{default:o(()=>[t(g,{modelValue:e.searchId,"onUpdate:modelValue":l[0]||(l[0]=a=>e.searchId=a),placeholder:"请输入专题评论编号"},null,8,["modelValue"])]),_:1}),t(i,{type:"primary",onClick:e.search},{default:o(()=>[s("查询")]),_:1},8,["onClick"]),t(i,{type:"info",onClick:e.research},{default:o(()=>[s("重置")]),_:1},8,["onClick"]),t(i,{type:"success",onClick:e.toAdd,style:{float:"right","margin-right":"40px"}},{default:o(()=>[s("添加 ")]),_:1},8,["onClick"])]),t(f,{data:e.comments,style:{width:"95%",margin:"0 auto"}},{default:o(()=>[t(m,{prop:"id",label:"编号",width:"80"}),t(m,{prop:"memberNickName",label:"发布者昵称",width:"120"}),t(m,{prop:"subjectId",label:"专题编号",width:"120"}),t(m,{label:"显示状态",width:"120"},{default:o(a=>[s(b(a.row.showStatus==0?"不显示":"显示"),1)]),_:1}),t(m,{prop:"content",label:"评论内容",width:"150"}),t(m,{label:"创建时间",width:"120"},{default:o(a=>[s(b(a.row.createTime!=null?a.row.createTime.replace("T"," ").slice(0,19):""),1)]),_:1}),t(m,{fixed:"right",label:"功能管理",width:"140"},{default:o(a=>[t(i,{type:"warning",size:"small",onClick:j=>e.toEdit(a.row)},{default:o(()=>[s("更新")]),_:2},1032,["onClick"]),t(i,{type:"danger",size:"small",onClick:j=>e.del(a.row.id)},{default:o(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(w,{layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,style:{width:"95%",margin:"0 auto"},onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),t(k,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":l[7]||(l[7]=a=>e.dialogFormVisible=a),title:"专题评论编辑"},{footer:o(()=>[p("span",ee,[t(i,{onClick:l[6]||(l[6]=a=>e.dialogFormVisible=!1)},{default:o(()=>[s("取消")]),_:1}),t(i,{type:"primary",onClick:e.save},{default:o(()=>[s("保存 ")]),_:1},8,["onClick"])])]),default:o(()=>[t(y,{model:e.comment},{default:o(()=>[t(r,{label:"发布昵称","label-width":e.formLabelWidth},{default:o(()=>[t(g,{modelValue:e.comment.memberNickName,"onUpdate:modelValue":l[1]||(l[1]=a=>e.comment.memberNickName=a),placeholder:"请输入发布昵称",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),t(r,{label:"所属专题","label-width":e.formLabelWidth},{default:o(()=>[t(_,{onPageChange:e.pageChange,optionSource:e.subjects,modelValue:e.comment.subjectId,"onUpdate:modelValue":l[2]||(l[2]=a=>e.comment.subjectId=a),labelKey:"title",valueKey:"id",style:{width:"90%"},placeholder:"请选择所属专题",paginationOption:e.selectPage},null,8,["onPageChange","optionSource","modelValue","paginationOption"])]),_:1},8,["label-width"]),t(r,{label:"显示状态","label-width":e.formLabelWidth},{default:o(()=>[t(C,{modelValue:e.comment.showStatus,"onUpdate:modelValue":l[3]||(l[3]=a=>e.comment.showStatus=a),placeholder:"请选择显示状态",style:{width:"80%"}},{default:o(()=>[t(h,{label:"不显示",value:0}),t(h,{label:"显示",value:1})]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),t(r,{label:"评论内容","label-width":e.formLabelWidth},{default:o(()=>[t(g,{modelValue:e.comment.content,"onUpdate:modelValue":l[4]||(l[4]=a=>e.comment.content=a),placeholder:"请输入评论内容",type:"textarea",style:{width:"80%"},rows:3},null,8,["modelValue"])]),_:1},8,["label-width"]),t(r,{label:"创建时间","label-width":e.formLabelWidth},{default:o(()=>[p("div",x,[t(V,{modelValue:e.comment.createTime,"onUpdate:modelValue":l[5]||(l[5]=a=>e.comment.createTime=a),type:"datetime",placeholder:"请选择创建时间"},null,8,["modelValue"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const re=P(X,[["render",te],["__scopeId","data-v-35a34805"]]);export{re as default};
